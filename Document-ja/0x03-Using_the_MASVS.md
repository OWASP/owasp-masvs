# モバイルアプリケーションセキュリティ検証標準

MASVSを使用することでモバイルアプリのセキュリティに信頼レベルを確立することができます。要件は以下の目標を念頭において開発されました。

- メトリックとして使用する - 開発者およびアプリケーション所有者により既存のモバイルアプリと比較できるセキュリティ標準を提供すること。
- ガイダンスとして使用する - モバイルアプリ開発およびテストのすべてのフェーズでのガイダンスを提供すること。
- 調達時に使用する - モバイルアプリのセキュリティ検証のベースラインを提供すること。

## モバイルアプリセキュリティモデル

MASVSは2つのセキュリティ検証レベル(MASVS-L1およびMASVS-L2)と一連のリバースエンジニアリング耐性要件(MASVS-R)を定義しています。MASVS-L1 は一般的なセキュリティ要件であり、すべてのモバイルアプリに推奨されます。MASVS-L2 は機密性の高いデータを扱うアプリに適用します。MASVS-R は追加の保護コントロールを対象としています。クライアント側の脅威を防止することが設計の目標である場合に適用できます。

MASVS-L1 の要件を満たすことで、セキュリティベストプラクティスに従い、一般的な脆弱性に苦しむことのないセキュアなアプリケーションを実現します。MASVS-L2 は SSL ピンニングなどの追加の多層防御コントロールを加えて、より洗練された攻撃に対し耐性のあるアプリをもたらします。モバイルオペレーティングシステムのセキュリティコントロールが損なわれていないこと、およびエンドユーザーが潜在的な敵対者とみなされないことを仮定しています。MASVS-R のソフトウェア保護要件のすべてもしくは一部を満たすことは、エンドユーザーに悪意のある場合やモバイルOSが侵害された場合に、特定のクライアントサイドの脅威に対しての防御に役立ちます。

**I: すべてのアプリに MASVS-L1 コントロールを実装することを推奨しますが、コントロールを実装するかどうかは最終的にはリスクに基づいて決定する必要があります。その決定はビジネスオーナーとともに対話して行います。**

**II: 注意。MASVS-R や OWASP Mobile Security Testing Guide に列挙されているソフトウェア保護対策は、根本的にバイパスできないわけではありません。それで、種々のセキュリティコントロールの代用として使用すべきではありません。むしろ、MASVS-L1 もしくは MASVS-L2 として示した MASVS 要件をも満たす、脅威に対応した、適切なソフトウェア保護対策を施してください。**

![Verification Levels](images/masvs-levels-new.jpg)

### ドキュメントの構成

MASVS の最初のパートには、セキュリティモデルおよび利用可能な検証レベルの説明と、実際に標準の使用方法に関する推奨事項が含まれます。次のパートには、詳細なセキュリティ要件と検証レベルへのマッピングが記載されています。要件は技術的な目的／スコープに基づいて8つのカテゴリ (V1～V8) に分類されています。MASVS および MSTG 全体で以下の命名法が使用されています。

- *要件カテゴリ:* MASVS-Vx, 例. MASVS-V2: データストレージとプライバシー
- *要件:* MASVS-Vx.y, 例. MASVS-V2.2: 「機密データがアプリケーションログに書き込まれていない。」

### 検証レベルの詳細

#### MASVS-L1: 標準セキュリティ

MASVS-L1 を実現するモバイルアプリはモバイルアプリケーションセキュリティのベストプラクティスに準拠しています。コード品質、機密データの取り扱い、モバイル環境との連携に関して基本的な要件を満たしています。セキュリティコントロールを検証するにはテストプロセスを実行する必要があります。このレベルはすべてのモバイルアプリケーションに適しています。

#### MASVS-L2: 多層防御

MASVS-L2 は標準要件を超える高度なセキュリティコントロールを導入します。MASVS-L2 を満たすためには、脅威モデルが存在する必要があり、セキュリティはアプリのアーキテクチャおよび設計の不可欠な部分である必要があります。脅威モデルに基づいて、適切な MASVS-L2 コントロールが選択され、正しく実装されているはずです。このレベルはモバイルバンキングアプリなどの機密性の高いデータを処理するアプリに適しています。

#### MASVS-R: リバースエンジニアリングと改竄への耐性

このアプリは最高水準のセキュリティを備えており、機密コードやデータを抽出するための改竄、改造、リバースエンジニアリングなどの特定の明確に定義されたクライアントサイドの攻撃に対しても耐性があります。このようなアプリはハードウェアのセキュリティ機能や十分に強力で検証可能なソフトウェア保護技術を活用しています。MASVS-R は機密性の高いデータを扱うアプリに適用され、知的財産を保護し、アプリの改竄を防止する手段となります。

### 推奨される使い方

アプリは事前のリスクアセスメントや要求される全体のセキュリティレベルに応じて MASVS L1 もしくは L2 に沿って検証できます。L1 はすべてのモバイルアプリに適用され、L2 は一般的により機密性の高いデータや機能を扱うアプリに推奨されます。MASVS-R（もしくはその一部）は適切なセキュリティ検証に *追加する* ことで、再パッケージ化や機密データの抽出などの特定の脅威に対する耐性を検証することができます。

要約すると、以下の検証タイプが利用できます。

- MASVS-L1
- MASVS-L1+R
- MASVS-L2
- MASVS-L2+R

それぞれの組み合わせには異なるグレードのセキュリティと耐性が反映されています。その目的は柔軟性を確保することです。例えば、モバイルゲームにはユーザビリティ上の理由から二要素認証などの MASVS-L2 セキュリティコントロールを加えることは容認されないかもしれませんが、改竄防止のための強いビジネスニーズがあります。

#### どの検証タイプを選択するか

MASVS L2 の要件を実装することでセキュリティが向上すると同時に、開発コストが増加し、エンドユーザーエクスペリエンスが悪化する可能性があります（典型的なトレードオフです）。一般的に、L2 はリスク対コストの観点から意味がある場合のアプリに使用すべきです（つまり、妥協した機密性もしくは完全性により引き起こされる潜在的な損失が追加のセキュリティコントロールによりもたらされるコストより高い場合）。リスクアセスメントは MASVS を適用する前の最初のステップであるべきです。

##### 事例

###### MASVS-L1

- すべてのモバイルアプリ。MASVS-L1 には開発コストとユーザーエクスペリエンスに妥当な影響を与えるセキュリティのベストプラクティスを掲載しています。より高いレベルのものに該当しないアプリには MASVS-L1 の要件を適用します。

###### MASVS-L2

- ヘルスケア業界：なりすまし犯罪や不正支払などのさまざまな犯罪行為に使用される個人識別情報を保管するモバイルアプリ。米国のヘルスケア分野では、医療保険の相互運用性と説明責任に関する法律 (HIPPA) のプライバシー、セキュリティ、侵害開示に関する規則、患者の安全性に関する規則があります。

- 金融業界：クレジットカード番号、個人情報などの機密性の高い情報にアクセスできたり、ユーザーが送金できるアプリ。これらのアプリは詐欺を防止するための追加のセキュリティコントロールを必要とします。金融アプリはPCIデータセキュリティスタンダード (PCIDSS)、グラム・リーチ・ブライリー法、サーベンス・オクスリー (SOX) 法に準拠する必要があります。

###### MASVS-L1+R

- 知的財産 (IP) 保護がビジネスゴールであるモバイルアプリ。MASVS-R に掲載されている耐性コントロールは元のソースコードを取得するのに必要な作業を増やし、改竄／クラッキングを防止するために使用できます。

- ゲーム業界：競争の激しいオンラインゲームなど、改造やチート行為を防止することが必要不可欠なゲーム。チート行為はオンラインゲームでの重要な問題です。大量のチート行為者がプレイヤーの不満を招き、最終的にはゲームが失敗となる可能性があります。MASVS-R はチート行為者への負担を増やすために基本的な耐タンパ性コントロールを提供します。

###### MASVS-L2+R

- 金融業界：ユーザーが送金できるオンラインバンキングアプリ。侵入したデバイスでのコードインジェクションやインストルメンテーションなどの技術によるリスクをもたらします。この場合、MASVS-R のコントロールを使用して改竄を防ぐことで、マルウェア作成者のハードルを上げることができます。

- 設計上、モバイルデバイス上に機密データを保存する必要があると同時に幅広いデバイスやオペレーティングシステムのバージョンをサポートしなければならないすべてのモバイルアプリ。この場合、機密データを抽出することを目指す攻撃者の負担を増やすために多層防御策として耐性コントロールを使用することができます。

- アプリ内購入のあるアプリでは有料コンテンツを保護するためにサーバー側コントロールと MASVS-L2 コントロールを使用するのが理想的です。但し、サーバー側保護を使用できない場合があります。このような場合、リバースや改竄の労力を増やすために MASVS-R コントロールをさらに適用する必要があります。
